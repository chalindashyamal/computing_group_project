<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>

    <!-- Firebase JavaScript SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.1/firebase-firestore.js"></script>
  </head>
  <body>
    <!-- Admin Panel -->
    <div class="container mt-5">
      <h2>Add Bus Schedule</h2>
      <form id="scheduleForm">
        <div class="mb-3">
          <label for="busRoute" class="form-label">Bus Route</label>
          <input type="text" class="form-control" id="busRoute" required />
        </div>
        <div class="mb-3">
          <label for="date" class="form-label">Date</label>
          <input type="date" class="form-control" id="date" required />
        </div>
        <div class="mb-3">
          <label for="departureTime" class="form-label">Departure Time</label>
          <input type="time" class="form-control" id="departureTime" required />
        </div>
        <button type="submit" class="btn btn-primary">Add Schedule</button>
      </form>
    </div>

    <!-- User Calendar -->
    <div class="container mt-5">
      <h2>Bus Schedule</h2>
      <div id="calendar"></div>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        const calendarEl = document.getElementById("calendar");
        const calendar = new FullCalendar.Calendar(calendarEl, {
          initialView: "dayGridMonth",
          events: [
            // Replace this with your code to fetch bus schedule data from the database
            { title: "Bus 138 to Nugegoda", start: "2023-03-15T16:30:00" },
            { title: "Bus 255 to Maharagama", start: "2023-03-16T17:00:00" },
          ],
        });
        calendar.render();
      });
    </script>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css"
      rel="stylesheet"
    />
    <script src="https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js"></script>

    <script>
      // Import Firebase modules
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-app.js";
      import {
        getDatabase,
        ref,
        push,
      } from "https://www.gstatic.com/firebasejs/10.8.1/firebase-database.js";

      // Firebase configuration
      const firebaseConfig = {
        apiKey: "AIzaSyCKYdEtZmhE_GLfR1LsIKf75e_YbQjDvSs",
        authDomain: "computing-project-f65ec.firebaseapp.com",
        databaseURL:
          "https://computing-project-f65ec-default-rtdb.firebaseio.com",
        projectId: "computing-project-f65ec",
        storageBucket: "computing-project-f65ec.appspot.com",
        messagingSenderId: "126022707574",
        appId: "1:126022707574:web:795b761b783e0dfa62f257",
        measurementId: "G-XG2N2HVR9M",
      };

      // Initialize Firebase
      const app = initializeApp(firebaseConfig);
      const database = getDatabase(app);

      firestore
        .collection("schedules")
        .get()
        .then((querySnapshot) => {
          if (querySnapshot.empty) {
            // Collection doesn't exist, create it
            firestore.collection("schedules").doc("placeholder").set({}); // Set a dummy document to create the collection
            console.log(
              "Firestore collection 'schedules' created successfully."
            );
          } else {
            console.log("Firestore collection 'schedules' already exists.");
          }
        })
        .catch((error) => {
          console.error(
            "Error creating Firestore collection 'schedules': ",
            error
          );
        });
    </script>
  </body>
</html>
